{% extends "base.html" %}
{% import "bootstrap/wtf.html" as wtf %}

{% block title %}Remove Device{% endblock %}

{% block page_content %}
<div class="container">
	<div class="row">
		<div class="page-header">
			<h1>Remove Device</h1>
		</div>
	</div>
	<div class="row">
		<div class="col-md-2">
		</div>
		<div class="col-md-4">
			{{ choose_form.device.label }} <br>
			{{ choose_form.device(class_="form-control")  }}
		</div>
		<div class="col-md-4">
			{% if error %}
					<p class="error"><strong>Error:</strong> {{ error }}</p>
			{% endif %}
			{% if devices %}
				{% for device in devices %}
					<div class="alert alert-info">
						<button type="button" class="btn-danger remove" id="{{ device.id }}">&times;</button>
						{{ device }}
					</div>
				{% endfor %}
			{% else %}
				<div class="alert alert-info">
					<p style="padding: 0.9%;">No devices of this type found</p>
				</div>
			{% endif %}
		</div>
		<div class="col-md-2">
		</div>
	</div>
</div>
{% endblock %}

{% block scripts %}
{{ super() }}
<script type="text/javascript">
	$(function() {
		$("#device").change(function () {
			$.ajax({
				type: "GET",
				url: "removedevice",
				data: {
						device: $("#device option:selected").val()
					  }
			}).done(function(msg) {
				document.open();
				document.write(msg);
				document.close();
			});
		});
	});

	$(function() {
		$(".remove").on("click", function (e) {
			$.ajax({
				type: "POST",
				url: "removedevice",
				data: {
						device_type: "{{ device_type }}",
						id: e.target.id
					  }
			}).done(function(msg) {
				document.open();
				document.write(msg);
				document.close();
			});
		});
	});
</script>
{% endblock %}
